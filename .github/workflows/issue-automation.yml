name: SprintFlow Issue Bot

on:
  issue_comment:
    types: [created]

jobs:
  auto-pr-creation:
    runs-on: ubuntu-latest
    if: github.event.issue.pull_request == null && contains(github.event.comment.body, '/create-pr')
    
    steps:
      - name: '1. Checkout Repository'
        uses: actions/checkout@v4

      - name: '2. Setup Node.js Environment'
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: '3. Install Script Dependencies'
        run: npm install @octokit/rest

      - name: '4. Verify Filesystem'
        run: |
          echo "Listing files in the workspace:"
          ls -R

      - name: '5. Execute PR Creation Script'
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}
          OWNER: ${{ github.repository_owner }}
          REPO: ${{ github.event.repository.name }}
        run: node scripts/auto-pr-creator.js 